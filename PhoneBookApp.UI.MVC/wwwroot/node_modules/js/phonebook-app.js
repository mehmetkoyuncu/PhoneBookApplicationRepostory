

$(document).ready(function () {

    GetPerson();

});
function AddPerson() {
    var Name = $('#addName').val();
    var Surname = $('#addSurname').val();
    var CompanyName = $('#addCompanyname').val();
    debugger;
    $.ajax({
        type: "POST",
        url: "https://localhost:44351/person/addperson",
        datatype: "json",
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify({ 'Name': Name, 'Surname': Surname, 'CompanyName': CompanyName }),
        success: function (data) {
            if (data == true) {
                swal({
                    title: "Kişi Başarıyla Rehbere Eklendi..",
                    icon: "success",
                    button: "Tamam",
                });
            }
            else {
                swal({
                    title: "Kişi Ekleme Başarısız !",
                    text: "Lütfen Daha Sonra Tekrar Deneyiniz..",
                    icon: "error",
                    button: "Tamam",
                });
            }
            $("#addPersonModal .close").click();
        }
    });
}
function DeletePerson(id) {
    swal({
        title: "Silmek İstediğinize Emin Misiniz ?",
        text: "Kişi rehberinizden silinecektir..",
        icon: "warning",
        buttons: ["Çık", "Sil"],
    })
        .then((willDelete) => {
            if (willDelete) {
                debugger;
                $.ajax({
                    type: "DELETE",
                    url: "https://localhost:44351/person/removeperson",
                    datatype: "json",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({ 'id': id }),
                    success: function (data) {
                        if (data == true) {
                            swal({
                                title: "Kişi Başarıyla Silindi..",
                                icon: "success",
                                button: "Tamam",
                            });
                            debugger;
                        }
                        else {
                            swal({
                                title: "Kişi Silme Başarısız..",
                                text: "Lütfen Daha Sonra Tekrar Deneyiniz..",
                                icon: "error",
                                button: "Tamam",
                            });
                        }
                    }
                });
            }
        });
}
function GetPerson() {
    $.ajax({
        type: "GET",
        url: "https://localhost:44351/person/GetAllPerson",
        datatype: "json",
        contentType: "application/json; charset=utf-8",
        success: function (data) {
            $("#tablePerson").DataTable({
                pageLength: 5,
                lengthMenu: [[5, 10, 20, -1], [5, 10, 20, 'Tümü']],
                "order": [[2, "desc"]],
                data: data,
                "columns": [
                    { data: "name", "autoWidth": true },
                    { data: "surname", "autoWidth": true },
                    { data: "companyName", "autoWidth": true },
                    {
                        "render": function (data, type, row) {
                            return "<a href='#' class='btn btn-primary' data-toggle='modal' data-target='#ViewContactModal' onclick=ViewContact('" + row.id + "'); ><i class=\"fas fa-eye mr-1\"></i>İncele</a>"
                        }
                    },
                    {
                        "render": function (data, type, row) {
                            return "<a  class='btn btn-danger text-light' onclick=DeletePerson('" + row.id + "')><i class=\"fas fa-trash-alt mr-1\"></i>Sil</a>";
                        }
                    }
                ]

            });
        }
    });
}
function DeleteContact(id) {
    var Id = Number(id);
    debugger;
    swal({
        title: "Silmek İstediğinizden Emin Misiniz ?",
        text: "İletişim Bilgisi Silinecektir !",
        icon: "warning",
        buttons: ["Çık", "Sil"],
    })
        .then((willDelete) => {
            if (willDelete) {
                debugger;
                $.ajax({
                    type: "DELETE",
                    url: "https://localhost:44351/contact/RemoveContact",
                    datatype: "json",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({ "Id": Id }),
                    success: function (data) {
                        if (data == true) {
                            swal({
                                title: "İletişim Bilgisi Başarıyla Silindi..",
                                icon: "success",
                                button: "Tamam",
                            });
                            debugger;
                        }
                        else {
                            swal({
                                title: "İletişim Bilgisi Silme Başarısız..",
                                text: "Lütfen Daha Sonra Tekrar Deneyiniz..",
                                icon: "error",
                                button: "Tamam",
                            });
                        }
                    }
                });
            }
        });
    
}
function ViewContact(id) {
    debugger;
    $.ajax({
        type: "POST",
        url: "https://localhost:44351/contact/GetContactForUser",
        datatype: "json",
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify({ 'userid': id }),
        success: function (data) {
            $("#tableContact").DataTable({
                data: data,
                "columns": [
                    { data: "personName", "autoWidth": true },
                    { data: "phoneNum" },
                    { data: "mail", "autoWidth": true },
                    { data: "address", "autoWidth": true },

                    {
                        "render": function (data, type, row) {
                         return "<a href='#' class='btn btn-danger' onclick=DeleteContact('" + row.id + "') ><i class=\"fas fa-trash-alt mr-1\"></i>Sil</a>";
                        }
                    }
                ]

            });
            document.getElementById('personIdHide').innerHTML = id;
            debugger;
        }
    });


}
function AddContact() {
    var Mail = $('#mail').val();
    var PhoneNum = $('#phoneNum').val();
    var Address = $('#addresss').val();
    var UserId = document.getElementById("personIdHide").innerHTML;
    debugger;
    $.ajax({
        type: "POST",
        url: "https://localhost:44351/contact/addcontact",
        datatype: "json",
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify({ 'PhoneNum': PhoneNum, 'Address': Address, 'Mail': Mail, 'UserId': UserId }),
        success: function (data) {
            if (data == true) {
                swal({
                    title: "İletişim Bilgisi Başarıyla Rehbere Eklendi..",
                    icon: "success",
                    button: "Tamam",
                });
                debugger;
            }
            else {
                swal({
                    title: "İletişim Bilgisi Ekleme Başarısız !",
                    text: "Lütfen Daha Sonra Tekrar Deneyiniz..",
                    icon: "error",
                    button: "Tamam",
                });
            }
            $("#ViewContactModal .close").click(); 
        }
    });

}

$("#GetReport").click(function () {
    var Address = "Deneme"
    debugger;
    $.ajax({
        type: "POST",
        url: "https://localhost:44351/contact/GetRecordCounts",
        datatype: "json",
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify({ 'Address': Address }),
        success: function (data) {
            debugger;
            var a = data.locationCount;
            var b = data.personCount;
            var c = data.name;
            debugger;
            document.getElementById('locationCount').innerHTML = a;
            document.getElementById('personCount').innerHTML = b;
            document.getElementById('pName').innerHTML = c;
            console.log("ready!");
            debugger;
        }
    });
});





//function GetLocationReport() {
//    var Address = "Adana";
//    debugger;
//    $.ajax({
//        type: "POST",
//        url: "https://localhost:44351/contact/GetLocationReport",
//        datatype: "json",
//        contentType: "application/json; charset=utf-8",
//        data: JSON.stringify({ 'Address': Address}),
//        success: function (data) {
//            $("#tableContact").DataTable({
//                data: data,
//                "columns": [
//                    { data: "personName", "autoWidth": true },
//                    { data: "phoneNum" },
//                    { data: "mail", "autoWidth": true },
//                    { data: "address", "autoWidth": true },

//                    {
//                        "render": function (data, type, row) {
//                            //return "<a class='btn btn-danger text-light' onclick="myFunction(row.id)" id='" + row.id + "'><i class=\"far fa-trash-alt deletedItem\"></i>Sil</a>";
//                            return "<a href='#' class='btn btn-danger' onclick=DeleteContact('" + row.id + "'); >Delete</a>";
//                        }
//                    }
//                ]

//            });
//            document.getElementById('personIdHide').innerHTML = id;
//            debugger;
//        }
//    });
//}





   
   







